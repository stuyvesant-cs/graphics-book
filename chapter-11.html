<!DOCTYPE html>
<!--********************************************-->
<!--*       Generated from PreTeXt source      *-->
<!--*                                          *-->
<!--*         https://pretextbook.org          *-->
<!--*                                          *-->
<!--********************************************-->
<html lang="en-US">
<head xmlns:og="http://ogp.me/ns#" xmlns:book="https://ogp.me/ns/book#">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Z Buffering</title>
<meta name="Keywords" content="Authored in PreTeXt">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta property="og:type" content="book">
<meta property="book:title" content="Computer Graphics">
<meta property="book:author" content="JonAlf Dyrland-Weaver">
<script>var runestoneMathReady = new Promise((resolve) => window.rsMathReady = resolve);
window.MathJax = {
  tex: {
    inlineMath: [['\\(','\\)']],
    tags: "none",
    tagSide: "right",
    tagIndent: ".8em",
    packages: {'[+]': ['base', 'extpfeil', 'ams', 'amscd', 'color', 'newcommand', 'knowl']}
  },
  options: {
    ignoreHtmlClass: "tex2jax_ignore|ignore-math",
    processHtmlClass: "process-math",
  },
  chtml: {
    scale: 0.98,
    mtextInheritFont: true
  },
  loader: {
    load: ['input/asciimath', '[tex]/extpfeil', '[tex]/amscd', '[tex]/color', '[tex]/newcommand', '[pretext]/mathjaxknowl3.js'],
    paths: {pretext: "https://pretextbook.org/js/lib"},
  },
  startup: {
    pageReady() {
      return MathJax.startup.defaultPageReady().then(function () {
      console.log("in ready function");
      rsMathReady();
      }
    )}
  },
};
</script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script><script src="https://unpkg.com/lunr/lunr.js"></script><script src="lunr-pretext-search-index.js" async=""></script><script src="https://pretextbook.org/js/0.2/pretext_search.js"></script><link href="https://pretextbook.org/css/0.6/pretext_search.css" rel="stylesheet" type="text/css">
<script>js_version = 0.2</script><script src="https://pretextbook.org/js/lib/jquery.min.js"></script><script src="https://pretextbook.org/js/lib/jquery.sticky.js"></script><script src="https://pretextbook.org/js/lib/jquery.espy.min.js"></script><script src="https://pretextbook.org/js/0.2/pretext.js"></script><script>miniversion=0.1</script><script src="https://pretextbook.org/js/0.2/pretext_add_on.js?x=1"></script><script src="https://pretextbook.org/js/0.2/user_preferences.js"></script><script src="https://pretextbook.org/js/lib/knowl.js"></script><!--knowl.js code controls Sage Cells within knowls--><script>sagecellEvalName='Evaluate (Sage)';
</script><link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
<link href="https://fonts.googleapis.com/css2?family=Inconsolata:wght@400;700&amp;family=Noto+Serif:ital,wght@0,400;0,700;1,400;1,700&amp;family=Tinos:ital,wght@0,400;0,700;1,400;1,700&amp;display=swap" rel="stylesheet">
<link href="https://fonts.cdnfonts.com/css/dejavu-serif" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Roboto+Serif:opsz,wdth,wght@8..144,50..150,100..900&amp;display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Open+Sans:wdth,wght@75..100,300..800&amp;display=swap" rel="stylesheet">
<link href="https://pretextbook.org/css/0.6/pretext.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.6/pretext_add_on.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.6/shell_default.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.6/banner_default.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.6/navbar_default.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.6/toc_default.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.6/knowls_default.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.6/style_default.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.6/colors_blue_red.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.6/setcolors.css" rel="stylesheet" type="text/css">
</head>
<body class="pretext book ignore-math">
<a class="assistive" href="#ptx-content">Skip to main content</a><header id="ptx-masthead"><div class="ptx-banner">
<a id="logo-link" href=""></a><div class="title-container">
<h1 class="heading"><a href="stuy-gfx.html"><span class="title">Computer Graphics:</span> <span class="subtitle">A Language Agnostic Guide to Fakin' It</span></a></h1>
<p class="byline">JonAlf Dyrland-Weaver</p>
</div>
<div id="searchresultsplaceholder" style="display: none">
<button id="closesearchresults" onclick="document.getElementById('searchresultsplaceholder').style.display = 'none'; return false;">x</button><h2>Search Results: <span id="searchterms"></span>
</h2>
<div id="searchempty"><span>No results.</span></div>
<ol id="searchresults"></ol>
</div>
</div></header><nav id="ptx-navbar" class="navbar"><button class="toc-toggle button" aria-label="Show or hide table of contents"><span class="icon">☰</span><span class="name">Contents</span></button><button id="user-preferences-button" class="user-preferences-button button" title="Modify user preferences"><span id="theavatarbutton" class="name">You!</span><div id="preferences_menu_holder" class="hidden"><ol id="preferences_menu" style="font-family: 'Roboto Serif', serif;">
<li data-env="avatar" tabindex="-1">Choose avatar<div class="wrap_to_submenu"><span class="to_submenu">▻</span></div>
<ol class="hidden avatar">
<li data-val="You!" tabindex="-1">
<span id="theYou!" class="avatarcheck">✔️</span>You!</li>
<li data-val="😺" tabindex="-1">
<span id="the😺" class="avatarcheck"></span>😺</li>
<li data-val="👤" tabindex="-1">
<span id="the👤" class="avatarcheck"></span>👤</li>
<li data-val="👽" tabindex="-1">
<span id="the👽" class="avatarcheck"></span>👽</li>
<li data-val="🐶" tabindex="-1">
<span id="the🐶" class="avatarcheck"></span>🐶</li>
<li data-val="🐼" tabindex="-1">
<span id="the🐼" class="avatarcheck"></span>🐼</li>
<li data-val="🌈" tabindex="-1">
<span id="the🌈" class="avatarcheck"></span>🌈</li>
</ol>
</li>
<li data-env="fontfamily" tabindex="-1">Font family<div class="wrap_to_submenu"><span class="to_submenu">▻</span></div>
<ol class="hidden fontfamily">
<li data-val="face" data-change="OS" tabindex="-1" style="font-family: 'Open Sans'">
<span id="theOS" class="ffcheck">✔️</span><span class="name">Open Sans</span><span class="sample">AaBbCc 123 PreTeXt</span>
</li>
<li data-val="face" data-change="RS" tabindex="-1" style="font-family: 'Roboto Serif'">
<span id="theRS" class="ffcheck"></span><span class="name">Roboto Serif</span><span class="sample">AaBbCc 123 PreTeXt</span>
</li>
</ol>
</li>
<li data-env="font" tabindex="-1">Adjust font<div class="wrap_to_submenu"><span class="to_submenu">▻</span></div>
<ol class="hidden fonts">
<li>Size</li>
<li><span id="thesize">12</span></li>
<li data-val="size" data-change="-1" tabindex="-1" style="font-size: 80%">Smaller</li>
<li data-val="size" data-change="1" tabindex="-1" style="font-size: 110%">Larger</li>
<li>Width</li>
<li><span id="thewdth">100</span></li>
<li data-val="wdth" data-change="-5" tabindex="-1" style="font-variation-settings: 'wdth' 60">narrower</li>
<li data-val="wdth" data-change="5" tabindex="-1" style="font-variation-settings: 'wdth' 150">wider</li>
<li>Weight</li>
<li><span id="thewght">400</span></li>
<li data-val="wght" data-change="-50" tabindex="-1" style="font-weight: 200">thinner</li>
<li data-val="wght" data-change="50" tabindex="-1" style="font-weight: 700">heavier</li>
<li>Letter spacing</li>
<li>
<span id="thelspace">0</span><span class="byunits">/200</span>
</li>
<li data-val="lspace" data-change="-1" tabindex="-1">closer</li>
<li data-val="lspace" data-change="1" tabindex="-1">f a r t h e r</li>
<li>Word spacing</li>
<li>
<span id="thewspace">0</span><span class="byunits">/50</span>
</li>
<li data-val="wspace" data-change="-1" tabindex="-1">smaller gap </li>
<li data-val="wspace" data-change="1" tabindex="-1">larger gap</li>
<li>Line Spacing</li>
<li>
<span id="theheight">135</span><span class="byunits">/100</span>
</li>
<li data-val="height" data-change="-5" tabindex="-1" style="line-height: 1">closer<br>together</li>
<li data-val="height" data-change="5" tabindex="-1" style="line-height: 1.75">further<br>apart</li>
</ol>
</li>
<li data-env="atmosphere" tabindex="-1">Light/dark mode<div class="wrap_to_submenu"><span class="to_submenu">▻</span></div>
<ol class="hidden atmosphere">
<li data-val="default" tabindex="-1">
<span id="thedefault" class="atmospherecheck">✔️</span>default</li>
<li data-val="pastel" tabindex="-1">
<span id="thepastel" class="atmospherecheck"></span>pastel</li>
<li data-val="darktwilight" tabindex="-1">
<span id="thedarktwilight" class="atmospherecheck"></span>twilight</li>
<li data-val="dark" tabindex="-1">
<span id="thedark" class="atmospherecheck"></span>dark</li>
<li data-val="darkmidnight" tabindex="-1">
<span id="thedarkmidnight" class="atmospherecheck"></span>midnight</li>
</ol>
</li>
<li data-env="ruler" tabindex="-1">Reading ruler<div class="wrap_to_submenu"><span class="to_submenu">▻</span></div>
<ol class="hidden ruler">
<li data-val="none" tabindex="-1">
<span id="thenone" class="rulercheck">✔️</span>none</li>
<li data-val="underline" tabindex="-1">
<span id="theunderline" class="rulercheck"></span>underline</li>
<li data-val="lunderline" tabindex="-1">
<span id="thelunderline" class="rulercheck"></span>L-underline</li>
<li data-val="greybar" tabindex="-1">
<span id="thegreybar" class="rulercheck"></span>grey bar</li>
<li data-val="lightbox" tabindex="-1">
<span id="thelightbox" class="rulercheck"></span>light box</li>
<li data-val="sunrise" tabindex="-1">
<span id="thesunrise" class="rulercheck"></span>sunrise</li>
<li data-val="sunriseunderline" tabindex="-1">
<span id="thesunriseunderline" class="rulercheck"></span>sunrise underline</li>
<li class="moveQ">Motion by:</li>
<li data-val="mouse" tabindex="-1">
<span id="themouse" class="motioncheck">✔️</span>follow the mouse</li>
<li data-val="arrow" tabindex="-1">
<span id="thearrow" class="motioncheck"></span>up/down arrows - not yet</li>
<li data-val="eye" tabindex="-1">
<span id="theeye" class="motioncheck"></span>eye tracking - not yet</li>
</ol>
</li>
</ol></div></button><span class="treebuttons"><a class="previous-button button" href="chapter-10.html" title="Previous"><span class="icon">&lt;</span><span class="name">Prev</span></a><a class="up-button button" href="part-4.html" title="Up"><span class="icon">^</span><span class="name">Up</span></a><a class="next-button button" href="chapter-12.html" title="Next"><span class="name">Next</span><span class="icon">&gt;</span></a></span><div class="searchbox"><div class="searchwidget">
<input id="ptxsearch" type="text" name="terms" placeholder="Search" onchange="doSearch()"><button id="searchbutton" type="button" onclick="doSearch()">🔍</button>
</div></div></nav><div id="latex-macros" class="hidden-content process-math" style="display:none"><span class="process-math">\(\newcommand{\R}{\mathbb R}
\newcommand{\lt}{&lt;}
\newcommand{\gt}{&gt;}
\newcommand{\amp}{&amp;}
\definecolor{fillinmathshade}{gray}{0.9}
\newcommand{\fillinmath}[1]{\mathchoice{\colorbox{fillinmathshade}{$\displaystyle     \phantom{\,#1\,}$}}{\colorbox{fillinmathshade}{$\textstyle        \phantom{\,#1\,}$}}{\colorbox{fillinmathshade}{$\scriptstyle      \phantom{\,#1\,}$}}{\colorbox{fillinmathshade}{$\scriptscriptstyle\phantom{\,#1\,}$}}}
\)</span></div>
<div class="ptx-page">
<div id="ptx-sidebar"><nav id="ptx-toc" class="depth2 parts"><ul class="structural">
<li><div class="toc-item"><a href="frontmatter.html" class="internal"><span class="title">Front Matter</span></a></div></li>
<li>
<div class="toc-item"><a href="part-1.html" class="internal"><span class="codenumber">I</span> <span class="title">2-D structures</span></a></div>
<ul class="structural">
<li>
<div class="toc-item"><a href="chapter-1.html" class="internal"><span class="codenumber">1</span> <span class="title">Colors, Depth, Space (and Time?)</span></a></div>
<ul class="structural"><li>
<div class="toc-item"><a href="chapter-1.html#section-1" class="internal"><span class="codenumber">1.1</span> <span class="title">Image File Formats</span></a></div>
<ul class="structural">
<li><div class="toc-item"><a href="chapter-1.html#subsection-1" class="internal"><span class="codenumber">1.1.1</span> <span class="title">Vector Formats</span></a></div></li>
<li><div class="toc-item"><a href="chapter-1.html#subsection-2" class="internal"><span class="codenumber">1.1.2</span> <span class="title">Raster Formats</span></a></div></li>
<li><div class="toc-item"><a href="chapter-1.html#subsection-3" class="internal"><span class="codenumber">1.1.3</span> <span class="title">NetPBM File Formats</span></a></div></li>
</ul>
</li></ul>
</li>
<li>
<div class="toc-item"><a href="chapter-2.html" class="internal"><span class="codenumber">2</span> <span class="title">Bresenham's Line Algorithm</span></a></div>
<ul class="structural">
<li><div class="toc-item"><a href="chapter-2.html#section-2" class="internal"><span class="codenumber">2.1</span> <span class="title">The Problem</span></a></div></li>
<li><div class="toc-item"><a href="chapter-2.html#section-3" class="internal"><span class="codenumber">2.2</span> <span class="title">Testing Potential Points</span></a></div></li>
<li>
<div class="toc-item"><a href="chapter-2.html#section-4" class="internal"><span class="codenumber">2.3</span> <span class="title">Developing the Algorithm</span></a></div>
<ul class="structural">
<li><div class="toc-item"><a href="chapter-2.html#subsection-4" class="internal"><span class="codenumber">2.3.1</span> <span class="title">Round I: Testing Both Points</span></a></div></li>
<li><div class="toc-item"><a href="chapter-2.html#subsection-5" class="internal"><span class="codenumber">2.3.2</span> <span class="title">Round II: Testing the Midpoint</span></a></div></li>
<li><div class="toc-item"><a href="chapter-2.html#subsection-6" class="internal"><span class="codenumber">2.3.3</span> <span class="title">The Testing Function</span></a></div></li>
<li><div class="toc-item"><a href="chapter-2.html#subsection-7" class="internal"><span class="codenumber">2.3.4</span> <span class="title">Round III: Testing No Points!</span></a></div></li>
</ul>
</li>
</ul>
</li>
<li>
<div class="toc-item"><a href="chapter-3.html" class="internal"><span class="codenumber">3</span> <span class="title">Edge Lists &amp; Matricies</span></a></div>
<ul class="structural">
<li><div class="toc-item"><a href="chapter-3.html#section-5" class="internal"><span class="codenumber">3.1</span> <span class="title">Using Edge Lists</span></a></div></li>
<li>
<div class="toc-item"><a href="chapter-3.html#section-6" class="internal"><span class="codenumber">3.2</span> <span class="title">Matrix Math for Graphics</span></a></div>
<ul class="structural">
<li><div class="toc-item"><a href="chapter-3.html#subsection-8" class="internal"><span class="codenumber">3.2.1</span> <span class="title">Matrix Multiplication</span></a></div></li>
<li><div class="toc-item"><a href="chapter-3.html#subsection-9" class="internal"><span class="codenumber">3.2.2</span> <span class="title">Multiplicative Identity</span></a></div></li>
</ul>
</li>
</ul>
</li>
<li>
<div class="toc-item"><a href="chapter-4.html" class="internal"><span class="codenumber">4</span> <span class="title">Transformations</span></a></div>
<ul class="structural">
<li>
<div class="toc-item"><a href="chapter-4.html#section-7" class="internal"><span class="codenumber">4.1</span> <span class="title">Transformation Matrices</span></a></div>
<ul class="structural">
<li><div class="toc-item"><a href="chapter-4.html#subsection-10" class="internal"><span class="codenumber">4.1.1</span> <span class="title">Translation</span></a></div></li>
<li><div class="toc-item"><a href="chapter-4.html#subsection-11" class="internal"><span class="codenumber">4.1.2</span> <span class="title">Dilation</span></a></div></li>
<li>
<div class="toc-item"><a href="chapter-4.html#subsection-12" class="internal"><span class="codenumber">4.1.3</span> <span class="title">Rotation</span></a></div>
<ul class="structural">
<li><div class="toc-item"><a href="chapter-4.html#subsubsection-1" class="internal"><span class="codenumber">4.1.3.1</span> <span class="title">Z-Axis Rotation</span></a></div></li>
<li><div class="toc-item"><a href="chapter-4.html#subsubsection-2" class="internal"><span class="codenumber">4.1.3.2</span> <span class="title">X-Axis Rotation</span></a></div></li>
<li><div class="toc-item"><a href="chapter-4.html#subsubsection-3" class="internal"><span class="codenumber">4.1.3.3</span> <span class="title">Y-Axis Rotation</span></a></div></li>
</ul>
</li>
</ul>
</li>
<li><div class="toc-item"><a href="chapter-4.html#section-8" class="internal"><span class="codenumber">4.2</span> <span class="title">Combining Transformations</span></a></div></li>
</ul>
</li>
<li>
<div class="toc-item"><a href="chapter-5.html" class="internal"><span class="codenumber">5</span> <span class="title">Parametric Equations &amp; Curves</span></a></div>
<ul class="structural">
<li>
<div class="toc-item"><a href="chapter-5.html#section-9" class="internal"><span class="codenumber">5.1</span> <span class="title">Parametric Equations</span></a></div>
<ul class="structural"><li><div class="toc-item"><a href="chapter-5.html#subsection-13" class="internal"><span class="codenumber">5.1.1</span> <span class="title">Parametric Circle</span></a></div></li></ul>
</li>
<li>
<div class="toc-item"><a href="chapter-5.html#section-10" class="internal"><span class="codenumber">5.2</span> <span class="title">Splines</span></a></div>
<ul class="structural">
<li><div class="toc-item"><a href="chapter-5.html#subsection-14" class="internal"><span class="codenumber">5.2.1</span> <span class="title">Hermite Curves</span></a></div></li>
<li>
<div class="toc-item"><a href="chapter-5.html#subsection-15" class="internal"><span class="codenumber">5.2.2</span> <span class="title">Bezier Curves</span></a></div>
<ul class="structural">
<li><div class="toc-item"><a href="chapter-5.html#subsubsection-4" class="internal"><span class="codenumber">5.2.2.1</span> <span class="title">Bezier Line</span></a></div></li>
<li><div class="toc-item"><a href="chapter-5.html#subsubsection-5" class="internal"><span class="codenumber">5.2.2.2</span> <span class="title">Bezier Quadratic</span></a></div></li>
<li><div class="toc-item"><a href="chapter-5.html#subsubsection-6" class="internal"><span class="codenumber">5.2.2.3</span> <span class="title">Bezier Cubic</span></a></div></li>
<li><div class="toc-item"><a href="chapter-5.html#subsubsection-7" class="internal"><span class="codenumber">5.2.2.4</span> <span class="title">Bezier Implementation</span></a></div></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>
<div class="toc-item"><a href="part-2.html" class="internal"><span class="codenumber">II</span> <span class="title">3-D Structures</span></a></div>
<ul class="structural">
<li>
<div class="toc-item"><a href="chapter-6.html" class="internal"><span class="codenumber">6</span> <span class="title">3D Shapes</span></a></div>
<ul class="structural">
<li><div class="toc-item"><a href="chapter-6.html#section-11" class="internal"><span class="codenumber">6.1</span> <span class="title">Box</span></a></div></li>
<li>
<div class="toc-item"><a href="chapter-6.html#section-12" class="internal"><span class="codenumber">6.2</span> <span class="title">Sphere</span></a></div>
<ul class="structural"><li><div class="toc-item"><a href="chapter-6.html#subsection-16" class="internal"><span class="codenumber">6.2.1</span> <span class="title">Sphere Point Generation</span></a></div></li></ul>
</li>
<li>
<div class="toc-item"><a href="chapter-6.html#section-13" class="internal"><span class="codenumber">6.3</span> <span class="title">Torus</span></a></div>
<ul class="structural"><li><div class="toc-item"><a href="chapter-6.html#subsection-17" class="internal"><span class="codenumber">6.3.1</span> <span class="title">Torus Point Generation</span></a></div></li></ul>
</li>
<li><div class="toc-item"><a href="chapter-6.html#section-14" class="internal"><span class="codenumber">6.4</span> <span class="title">Implementing 3D Shapes</span></a></div></li>
</ul>
</li>
<li>
<div class="toc-item"><a href="chapter-7.html" class="internal"><span class="codenumber">7</span> <span class="title">Polygons</span></a></div>
<ul class="structural">
<li><div class="toc-item"><a href="chapter-7.html#section-15" class="internal"><span class="codenumber">7.1</span> <span class="title">Polygon Lists</span></a></div></li>
<li>
<div class="toc-item"><a href="chapter-7.html#section-16" class="internal"><span class="codenumber">7.2</span> <span class="title">Polygon Based Shapes</span></a></div>
<ul class="structural">
<li><div class="toc-item"><a href="chapter-7.html#subsection-18" class="internal"><span class="codenumber">7.2.1</span> <span class="title">Box</span></a></div></li>
<li><div class="toc-item"><a href="chapter-7.html#subsection-19" class="internal"><span class="codenumber">7.2.2</span> <span class="title">Sphere</span></a></div></li>
<li><div class="toc-item"><a href="chapter-7.html#subsection-20" class="internal"><span class="codenumber">7.2.3</span> <span class="title">Torus</span></a></div></li>
</ul>
</li>
<li><div class="toc-item"><a href="chapter-7.html#section-17" class="internal"><span class="codenumber">7.3</span> <span class="title">Vectors</span></a></div></li>
<li>
<div class="toc-item"><a href="chapter-7.html#section-18" class="internal"><span class="codenumber">7.4</span> <span class="title">Backface Culling</span></a></div>
<ul class="structural">
<li><div class="toc-item"><a href="chapter-7.html#subsection-21" class="internal"><span class="codenumber">7.4.1</span> <span class="title">Calculate <span class="process-math">\(\overrightarrow{N}\)</span></span></a></div></li>
<li><div class="toc-item"><a href="chapter-7.html#subsection-22" class="internal"><span class="codenumber">7.4.2</span> <span class="title">Calculate <span class="process-math">\(\theta\)</span></span></a></div></li>
<li><div class="toc-item"><a href="chapter-7.html#subsection-23" class="internal"><span class="codenumber">7.4.3</span> <span class="title">Putting it all together</span></a></div></li>
</ul>
</li>
</ul>
</li>
<li>
<div class="toc-item"><a href="chapter-8.html" class="internal"><span class="codenumber">8</span> <span class="title">Backface Culling</span></a></div>
<ul class="structural">
<li><div class="toc-item"><a href="chapter-8.html#section-19" class="internal"><span class="codenumber">8.1</span> <span class="title">Vectors</span></a></div></li>
<li>
<div class="toc-item"><a href="chapter-8.html#section-20" class="internal"><span class="codenumber">8.2</span> <span class="title">The Algorithm</span></a></div>
<ul class="structural">
<li><div class="toc-item"><a href="chapter-8.html#subsection-24" class="internal"><span class="codenumber">8.2.1</span> <span class="title">Calculate <span class="process-math">\(\overrightarrow{N}\)</span></span></a></div></li>
<li><div class="toc-item"><a href="chapter-8.html#subsection-25" class="internal"><span class="codenumber">8.2.2</span> <span class="title">Calculate <span class="process-math">\(\theta\)</span></span></a></div></li>
<li><div class="toc-item"><a href="chapter-8.html#subsection-26" class="internal"><span class="codenumber">8.2.3</span> <span class="title">Putting it all together</span></a></div></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>
<div class="toc-item"><a href="part-3.html" class="internal"><span class="codenumber">III</span> <span class="title">Motion</span></a></div>
<ul class="structural"><li>
<div class="toc-item"><a href="chapter-9.html" class="internal"><span class="codenumber">9</span> <span class="title">Relative Coordinate Systems</span></a></div>
<ul class="structural"><li><div class="toc-item"><a href="chapter-9.html#section-21" class="internal"><span class="codenumber">9.1</span> <span class="title">The Global Coordinate System</span></a></div></li></ul>
</li></ul>
</li>
<li>
<div class="toc-item"><a href="part-4.html" class="internal"><span class="codenumber">IV</span> <span class="title">Lighting &amp; Shading</span></a></div>
<ul class="structural">
<li>
<div class="toc-item"><a href="chapter-10.html" class="internal"><span class="codenumber">10</span> <span class="title">Scanline Conversion</span></a></div>
<ul class="structural">
<li><div class="toc-item"><a href="chapter-10.html#section-22" class="internal"><span class="codenumber">10.1</span> <span class="title">Overview</span></a></div></li>
<li>
<div class="toc-item"><a href="chapter-10.html#section-23" class="internal"><span class="codenumber">10.2</span> <span class="title">Scanlines</span></a></div>
<ul class="structural">
<li><div class="toc-item"><a href="chapter-10.html#subsection-27" class="internal"><span class="codenumber">10.2.1</span> <span class="title">Calculating <span class="process-math">\(x_0\)</span></span></a></div></li>
<li><div class="toc-item"><a href="chapter-10.html#subsection-28" class="internal"><span class="codenumber">10.2.2</span> <span class="title">Calculating <span class="process-math">\(x_1\)</span></span></a></div></li>
</ul>
</li>
<li>
<div class="toc-item"><a href="chapter-10.html#section-24" class="internal"><span class="codenumber">10.3</span> <span class="title">The Algorithm</span></a></div>
<ul class="structural"><li><div class="toc-item"><a href="chapter-10.html#subsection-29" class="internal"><span class="codenumber">10.3.1</span> <span class="title">"Special" Triangles</span></a></div></li></ul>
</li>
</ul>
</li>
<li class="active">
<div class="toc-item"><a href="chapter-11.html" class="internal"><span class="codenumber">11</span> <span class="title">Z Buffering</span></a></div>
<ul class="structural">
<li><div class="toc-item"><a href="chapter-11.html#section-25" class="internal"><span class="codenumber">11.1</span> <span class="title">The Z-Buffer</span></a></div></li>
<li>
<div class="toc-item"><a href="chapter-11.html#section-26" class="internal"><span class="codenumber">11.2</span> <span class="title">Calculating <span class="process-math">\(z\)</span> Values</span></a></div>
<ul class="structural">
<li><div class="toc-item"><a href="chapter-11.html#subsection-30" class="internal"><span class="codenumber">11.2.1</span> <span class="title"><code class="code-inline tex2jax_ignore">scanline_convert</code></span></a></div></li>
<li><div class="toc-item"><a href="chapter-11.html#subsection-31" class="internal"><span class="codenumber">11.2.2</span> <span class="title"><code class="code-inline tex2jax_ignore">draw_line</code> and <code class="code-inline tex2jax_ignore">draw_scanline</code></span></a></div></li>
</ul>
</li>
</ul>
</li>
<li>
<div class="toc-item"><a href="chapter-12.html" class="internal"><span class="codenumber">12</span> <span class="title">Lighting Models</span></a></div>
<ul class="structural">
<li>
<div class="toc-item"><a href="chapter-12.html#section-27" class="internal"><span class="codenumber">12.1</span> <span class="title">Light Sources</span></a></div>
<ul class="structural">
<li><div class="toc-item"><a href="chapter-12.html#subsection-32" class="internal"><span class="codenumber">12.1.1</span> <span class="title">Ambient Light</span></a></div></li>
<li><div class="toc-item"><a href="chapter-12.html#subsection-33" class="internal"><span class="codenumber">12.1.2</span> <span class="title">Point Light Sources</span></a></div></li>
</ul>
</li>
<li>
<div class="toc-item"><a href="chapter-12.html#section-28" class="internal"><span class="codenumber">12.2</span> <span class="title">Reflection Types</span></a></div>
<ul class="structural">
<li><div class="toc-item"><a href="chapter-12.html#subsection-34" class="internal"><span class="codenumber">12.2.1</span> <span class="title">Ambient Reflection</span></a></div></li>
<li><div class="toc-item"><a href="chapter-12.html#subsection-35" class="internal"><span class="codenumber">12.2.2</span> <span class="title">Diffuse Reflection</span></a></div></li>
<li><div class="toc-item"><a href="chapter-12.html#subsection-36" class="internal"><span class="codenumber">12.2.3</span> <span class="title">Specular Reflection</span></a></div></li>
</ul>
</li>
</ul>
</li>
<li>
<div class="toc-item"><a href="chapter-13.html" class="internal"><span class="codenumber">13</span> <span class="title">Phong Reflection Models</span></a></div>
<ul class="structural">
<li><div class="toc-item"><a href="chapter-13.html#section-29" class="internal"><span class="codenumber">13.1</span> <span class="title">Overview</span></a></div></li>
<li><div class="toc-item"><a href="chapter-13.html#section-30" class="internal"><span class="codenumber">13.2</span> <span class="title">Ambient Reflection</span></a></div></li>
<li><div class="toc-item"><a href="chapter-13.html#section-31" class="internal"><span class="codenumber">13.3</span> <span class="title">Diffuse Reflection</span></a></div></li>
<li><div class="toc-item"><a href="chapter-13.html#section-32" class="internal"><span class="codenumber">13.4</span> <span class="title">Specular Reflection</span></a></div></li>
<li><div class="toc-item"><a href="chapter-13.html#section-33" class="internal"><span class="codenumber">13.5</span> <span class="title">Putting it All Together</span></a></div></li>
</ul>
</li>
</ul>
</li>
<li><div class="toc-item"><a href="backmatter.html" class="internal"><span class="title">Backmatter</span></a></div></li>
</ul></nav></div>
<main class="ptx-main"><div id="ptx-content" class="ptx-content">
<section class="chapter" id="chapter-11"><h2 class="heading">
<span class="type">Chapter</span> <span class="codenumber">11</span> <span class="title">Z Buffering</span>
</h2>
<section class="introduction" id="introduction-9">A hidden surface is any surface that is represented within our polygon matrices but would not be visible in the generated image. There are genrally two reasons a surface would be hidden; either it is facing away from the viewer, or it is being obstructed by another surface. Backfacce culling takes care of the first case, and Z-Buffering is how we will handle the second. Importantly, we could not work on this kind of hidden surface removal until after working on scanline conversion. Backface culling happens per polygon, eitehr the entire surface is visible or not based on its orientation. We cannot be certain that when one object is in front of another, that an entire polygon is covered, so in order to accurately deal with this, we need to be working at the pixel level. Now that we are scanline converting our images, we have a fraemwork in palce to visit all the pixels that should be drawn.</section><section class="section" id="section-25"><h3 class="heading hide-type">
<span class="type">Section</span> <span class="codenumber">11.1</span> <span class="title">The Z-Buffer</span>
</h3>
<div class="para" id="p-101">A Z-Buffer is a 2D array of <em class="emphasis">floating point</em> z values that maps directly to the 2D array of colors/pixels that contains our image. For example, the Z-buffer value at <span class="process-math">\((4, 10)\)</span> is the z coordinate for the pixel drawn at point <span class="process-math">\((4, 10)\text{.}\)</span> Since z values represent the depth of a pixel, we can use the Z-Buffer to keep track of how forward or backward any plotted pixel is.</div>
<div class="para" id="p-102">Currently when we plot a pixel we provide the <span class="process-math">\((x, y)\)</span> coordinates and color. Now we will provide <span class="process-math">\((x, y, z)\)</span> and a color. <span class="process-math">\((x, y)\)</span> will determine the position of the color in the image and the <span class="process-math">\(z\)</span> value in the Z-Buffer. Before we deicdee to plot a given pixel in the image, we will check the <span class="process-math">\(z\)</span> value against the value currently in the Z-Buffer.</div>
<div class="para" id="p-103">If the new <span class="process-math">\(z\)</span> is larger than the value in the Z-Buffer, that means that whatever pixel is currently plotted in the image comes from a shape that is <em class="emphasis">behind</em> the new pixel (remember, +z is closer to the viewer). When this happens we will update the image and Z-Buffer at the specified <span class="process-math">\((x, y)\)</span> position with the new color and <span class="process-math">\(z\)</span> value. Otherwise, we will skip plotting the pixel in the image and Z-Buffer, as there must already be an object at that position that is more forward.</div>
<div class="para" id="p-104">In order for this the Z-Buffer to work, we need a good value to initialize Z-Buffer entries to. What we want is a value that represents something so far behind that any object we add would be on top. This should be the smallest (most negative) value possible. In the math world, a resonable suggestion would be to use -∞. Turns out in the Computer Programming world, that is also the answer! There is in fact a standard way to represent both ∞ and -∞ with <a class="external" href="https://en.wikipedia.org/wiki/IEEE_754-1985#Positive_and_negative_infinity" target="_blank">floating point values</a><a href="" data-knowl="" class="id-ref fn-knowl original" data-refid="hk-fn-10" id="fn-10"><sup> 1 </sup></a>. Often dividing a negative floating point value by 0 will do this (i.e. <code class="code-inline tex2jax_ignore">-1.0/0.0</code>), but different programming languages often have constants defined for this value as well.</div></section><section class="section" id="section-26"><h3 class="heading hide-type">
<span class="type">Section</span> <span class="codenumber">11.2</span> <span class="title">Calculating <span class="process-math">\(z\)</span> Values</span>
</h3>
<div class="para" id="p-105">In addition to maintaining a Z-Buffer, we need to now calculate z values whenever we draw lines. This includes our <code class="code-inline tex2jax_ignore">draw_line</code>, <code class="code-inline tex2jax_ignore">scanline_convert</code>, and <code class="code-inline tex2jax_ignore">draw_scanline</code> (if you made a separate function to just draw scanlines) functions.</div>
<section class="subsection" id="subsection-30"><h4 class="heading hide-type">
<span class="type">Subsection</span> <span class="codenumber">11.2.1</span> <span class="title"><code class="code-inline tex2jax_ignore">scanline_convert</code></span>
</h4>
<div class="para" id="p-106">Here, <span class="process-math">\(z\)</span> values can be calculated the same way we find the <span class="process-math">\(x\)</span> values. We already have <span class="process-math">\(z\)</span> coordinates stored in out polygon matrices, we just need to calcualte the <span class="process-math">\(z\)</span> values as we move across each scanline. It is important to remember that unlike <span class="process-math">\(y\text{,}\)</span> we cannot be certain that the <span class="process-math">\(z\)</span> value is the same along the entire scanline.</div>
<div class="para" id="p-107">
<span class="process-math">\(z_0\)</span> is on the line <span class="process-math">\(\overline{BT}\text{,}\)</span> so it starts at <span class="process-math">\(z_b\)</span> and goes to <span class="process-math">\(z_t\text{.}\)</span> <span class="process-math">\(z_1\)</span> is on the line <span class="process-math">\(\overline{BM}\)</span> starting at <span class="process-math">\(z_b\)</span> going to <span class="process-math">\(z_m\)</span> and then it moves onto the line <span class="process-math">\(\overline{MT}\text{,}\)</span> going from <span class="process-math">\(z_m\)</span> to <span class="process-math">\(z_t\text{.}\)</span>
</div>
<div class="para logical" id="p-108">
<div class="para">You will need a <span class="process-math">\(\Delta z_0\)</span> and <span class="process-math">\(\Delta z_1\text{.}\)</span> These are calculated the same was as their <span class="process-math">\(x\)</span> equivalents:</div>
<div class="displaymath process-math">
\begin{equation*}
\Delta z = \dfrac{\text {total change in z}}{\text {number of scanlines}}
\end{equation*}
</div>
</div></section><section class="subsection" id="subsection-31"><h4 class="heading hide-type">
<span class="type">Subsection</span> <span class="codenumber">11.2.2</span> <span class="title"><code class="code-inline tex2jax_ignore">draw_line</code> and <code class="code-inline tex2jax_ignore">draw_scanline</code></span>
</h4>
<div class="para" id="p-109">We actually have to go back to our very first graphics algorithm and modify it to take <span class="process-math">\(z\)</span> values into account. On the plus side, we <em class="emphasis">need</em> <span class="process-math">\(z\)</span> values to be floating point based, so we will not have to try to map them as best we can to integers. This makes the calculation more straightforward. You can think of generating <span class="process-math">\(z\)</span> values in a similar way to what weed need to do in <code class="code-inline tex2jax_ignore">scanline_convert</code>.</div>
<div class="para logical" id="p-110">
<div class="para">If we are drawing a line from <span class="process-math">\((x_0, y_0, z_0)\)</span> to <span class="process-math">\((x_1, y_1, z_1)\text{,}\)</span> that means as we draw the line, <span class="process-math">\(z\)</span> must go from <span class="process-math">\(z_0\)</span> to <span class="process-math">\(z_1\text{.}\)</span> Since we draw our lines 1 pixel at a time, we need to figure out how much <span class="process-math">\(z\)</span> changes with each pixel. Like above:</div>
<div class="displaymath process-math">
\begin{equation*}
\Delta z = \dfrac{\text {total change in z}}{\text {number of pixels plotted}}
\end{equation*}
</div>
<div class="para">Note that the denominator is the <em class="emphasis"># of pixels</em> not the length of the line. If the line is in octants I or VIII, the total # of pixels is based on the <span class="process-math">\(x\)</span> values. If the line is in octants II or VII, the total # of pixels is based on the <span class="process-math">\(y\)</span> values. Think about the value that controls the loop that generates the line. Which coordinate is guaranteed to go up by 1 each time?</div>
</div></section></section></section><div class="hidden-content tex2jax_ignore" id="hk-fn-10"><div class="fn"><code class="code-inline tex2jax_ignore">en.wikipedia.org/wiki/IEEE_754-1985#Positive_and_negative_infinity</code></div></div>
</div>
<div class="ptx-content-footer">
<a class="previous-button button" href="chapter-10.html" title="Previous"><span class="icon">&lt;</span><span class="name">Prev</span></a><a class="top-button button" href="#" title="Top"><span class="icon">^</span><span class="name">Top</span></a><a class="next-button button" href="chapter-12.html" title="Next"><span class="name">Next</span><span class="icon">&gt;</span></a>
</div></main>
</div>
<div id="ptx-page-footer">
<a class="pretext-link" href="https://pretextbook.org" title="PreTeXt"><div class="logo"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="338 3000 8772 6866"><g style="stroke-width:.025in; stroke:black; fill:none"><polyline points="472,3590 472,9732 " style="stroke:#000000;stroke-width:174; stroke-linejoin:miter; stroke-linecap:round; "></polyline><path style="stroke:#000000;stroke-width:126;stroke-linecap:butt;" d="M 4724,9448 A 4660 4660  0  0  1  8598  9259"></path><path style="stroke:#000000;stroke-width:174;stroke-linecap:butt;" d="M 4488,9685 A 4228 4228  0  0  0   472  9732"></path><path style="stroke:#000000;stroke-width:126;stroke-linecap:butt;" d="M 4724,3590 A 4241 4241  0  0  1  8598  3496"></path><path style="stroke:#000000;stroke-width:126;stroke-linecap:round;" d="M 850,3496  A 4241 4241  0  0  1  4724  3590"></path><path style="stroke:#000000;stroke-width:126;stroke-linecap:round;" d="M 850,9259  A 4507 4507  0  0  1  4724  9448"></path><polyline points="5385,4299 4062,8125" style="stroke:#000000;stroke-width:300; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="8598,3496 8598,9259" style="stroke:#000000;stroke-width:126; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="850,3496 850,9259" style="stroke:#000000;stroke-width:126; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="4960,9685 4488,9685" style="stroke:#000000;stroke-width:174; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="3070,4582 1889,6141 3070,7700" style="stroke:#000000;stroke-width:300; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="6418,4582 7600,6141 6418,7700" style="stroke:#000000;stroke-width:300; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="8976,3590 8976,9732" style="stroke:#000000;stroke-width:174; stroke-linejoin:miter; stroke-linecap:round;"></polyline><path style="stroke:#000000;stroke-width:174;stroke-linecap:butt;" d="M 4960,9685 A 4228 4228  0  0  1  8976  9732"></path></g></svg></div></a><a class="runestone-link" href="https://runestone.academy" title="Runestone Academy"><img class="logo" src="https://runestone.academy/runestone/static/images/RAIcon_cropped.png"></a><a class="mathjax-link" href="https://www.mathjax.org" title="MathJax"><img class="logo" src="https://www.mathjax.org/badge/badge-square-2.png"></a>
</div>
</body>
</html>
